<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="member">

	<insert id="insert" parameterType="member">
		insert into member (id, password, email, name, 
							post, address, phone_num, birth, 
							gender, profile_img, profile_img_ori,
							login_type)
		values (#{id}, #{password, jdbcType=VARCHAR}, #{email}, #{name}, 
				#{post, jdbcType=VARCHAR}, #{address, jdbcType=VARCHAR}, #{phone_num, jdbcType=VARCHAR}, #{birth, jdbcType=VARCHAR},
				#{gender, jdbcType=VARCHAR}, #{profile_img, jdbcType=VARCHAR}, #{profile_img_ori, jdbcType=VARCHAR},
				#{login_type})
	</insert>
	
	<select id="memberInfo" parameterType="java.util.Map" resultType="member">
		select * 
		from member 
		where ${field} = #{value}
		and login_type = #{login_type}
	</select>
	
	<select id="memberInfoId" parameterType="String" resultType="member">
		select * 
		from member 
		where id = #{value}
	</select>
	
	<update id="update" parameterType="member">
		update member
		set password = #{password, jdbcType=VARCHAR},
			email = #{email, jdbcType=VARCHAR},
			name = #{name, jdbcType=VARCHAR}, 
			post = #{post, jdbcType=VARCHAR},
			address = #{address, jdbcType=VARCHAR},
			phone_num = #{phone_num, jdbcType=VARCHAR},
			birth = #{birth, jdbcType=VARCHAR}, 
			gender = #{gender, jdbcType=VARCHAR},
			profile_img = #{profile_img, jdbcType=VARCHAR},
			profile_img_ori = #{profile_img_ori, jdbcType=VARCHAR}
		where id = #{id}
	</update>
	
	<select id="search" parameterType="java.util.Map" resultType="member">
		select *
		from member
		where id != #{sessionId}
		and (id like '%${search}%'
		or name like '%${search}%')
		order by name
	</select>
	
	<select id="roomList" parameterType="String" resultType="com.naver.myhome.main.domain.ChatRoom">
		select *
		from chat_join
		where member_id = #{toId}
		and num in ()
		and chat_room_num in (select chat_room_num
							  from chat_join
							  where member_id = #{myId})
		
		select num from chat_join where 
	</select>
	
</mapper>